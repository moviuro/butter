.\" Text automatically generated by txt2man
.TH butter 8 "04 January 2016" "" ""
.SH NAME
\fBbutter is a btrfs snapshot manager.
\fB
.SH SYNOPSIS
.nf
.fam C
  \fBbutter\fP [\fB-d\fP] \fIadd\fP MOUNTPOINT[,\.\.\.] [\fITYPE\fP]
  \fBbutter\fP [\fB-d\fP] \fIbootstrap\fP
  \fBbutter\fP [\fB-d\fP] \fIcreate\fP \fIMOUNTPOINT\fP [\fIPROP\fP \fIVALUE\fP [\.\.\.]]
  \fBbutter\fP [\fB-d\fP] \fIdestroy\fP \fIMOUNTPOINT\fP
  \fBbutter\fP [\fB-d\fP] \fIlist\fP
  \fBbutter\fP [\fB-d\fP] \fIremove\fP \fIMOUNTPOINT\fP [\fITYPE\fP]
  \fBbutter\fP [\fB-d\fP] \fIsnaplist\fP
  \fBbutter\fP [\fB-d\fP] \fIsnapshot\fP \fIMOUNTPOINT\fP[,\.\.\.]|ALL [\fIPROP\fP \fIVALUE\fP [\.\.\.]]
  \fBbutter\fP [\fB-d\fP] \fIsnapremove\fP \fIMOUNTPOINT\fP[,\.\.\.] [\fICOUNT\fP [\fIPROP\fP \fIVALUE\fP [\.\.\.]]]
  \fBbutter\fP [\fB-d\fP] \fIset\fP \fIMOUNTPOINT\fP[,\.\.\.] \fIPROP\fP \fIVALUE\fP [\.\.\.]
  \fBbutter\fP [\fB-d\fP] \fIget\fP [\fB-H\fP] [\fB-o\fP \fIvalues\fP] \fIMOUNTPOINT\fP[,\.\.\.] \fIPROP\fP [\fIPROP\fP [\.\.\.]]
  \fBbutter\fP [\fB-d\fP] \fIhelp\fP
  \fBbutter\fP [\fB-d\fP] \fIfind\fP [\fIPROP\fP \fIVALUE\fP [\.\.\.]]

.fam T
.fi
.fam T
.fi
.SH DESCRIPTION
\fBbutter\fP manages snapshots and retention, while making extensive use of extended
attributes.
.PP
\fBbutter\fP \fB-d\fP [COMMAND [ARGS\.\.\.]]
.PP
.nf
.fam C
        Run butter in debug mode (bash(1)'s set -x)

.fam T
.fi
\fBbutter\fP \fIadd\fP \fIMOUNTPOINT\fP [\fITYPE\fP]
.PP
.nf
.fam C
        Adds a mountpoint to the default settings for a given type of snapshot.
        See also butter remove.

        Example:

        After issuing the following command,
          # butter add /,/home,/var hourly
        This next command will snapshot /, /home and /var
          # butter snapshot ALL type hourly

.fam T
.fi
\fBbutter\fP \fIbootstrap\fP
.PP
.nf
.fam C
        Tells you what to do to get started.  Will certainly get dropped.

        Typically, you should do this first:
          # mkdir -p /mnt/butter
          # mount -osubvol=/ /mnt/butter
          # mkdir -p /mnt/butter/96ee4786d7b24914bd61e2a6aa52ae1f

.fam T
.fi
\fBbutter\fP \fIcreate\fP \fIMOUNTPOINT\fP [\fIPROP\fP \fIVALUE\fP [\.\.\.]]
.PP
.nf
.fam C
        Will create a btrfs(8) subvolume in the butter root and set some initial
        values, as well as default values for the following properties:

          o mountpoint (obviously)
          o snapshot.default.max (defaults to 5)
          o uuid
          o snapshot.is (must be "0")

        The subvolume will be created inside the butter root and will not be
        mounted.

        Examples:

.nf
.fam C
          # butter create / snapshot.hourly.max 24 snapshot.daily.max 7
          # butter create /home snapshot.default.max 10

.fam T
.fi
\fBbutter\fP \fIdestroy\fP \fIMOUNTPOINT\fP
.PP
.nf
.fam C
        Will delete all subvolumes that have the given mountpoint (snapshots
        too) that live under the butter root

        Example:

.nf
.fam C
          # butter destroy /var

.fam T
.fi
\fBbutter\fP snapconfig
.PP
.nf
.fam C
        Shows snapshot type and mountpoints configuration, created using add
        and remove.
        It is useful to use it before issuing a snapshot command to "ALL".

        Example:

.nf
.fam C
          # butter snapconfig
          TYPE     MOUNTPOINT
          daily    /home
          daily    /var
          default  /home

.fam T
.fi
\fBbutter\fP \fIremove\fP \fIMOUNTPOINT\fP[,\.\.\.] [\fITYPE\fP]
.PP
.nf
.fam C
        Removes a mountpoint from the default list for a given snapshot type.
        See also butter add.
.nf
.fam C
        Example:
          # butter remove /var yearly

.fam T
.fi
\fBbutter\fP \fIsnaplist\fP
.PP
.nf
.fam C
        Lists all snapshots.  Does not show subvolumes.

.fam T
.fi
\fBbutter\fP \fIsnapshot\fP \fIMOUNTPOINT\fP|ALL [\fIPROP\fP \fIVALUE\fP [\.\.\.]]
.PP
.nf
.fam C
        Take a snapshot and set some properties, as well as some default values
        for the following properties:

          o snapshot.type (defaults to "default")
          o snapshot.is (must be "1")
          o snapshot.timestamp
          o uuid

        Examples:

        Snapshot /var/log with type "manual" and a comment
          # butter snapshot /var/log type manual comment "first shot at butter"

        Simply snapshot /home
          # butter snapshot /home

        Snapshot all subvolumes that must (see butter add) for a given type:
          # butter snapshot ALL type daily

.fam T
.fi
\fBbutter\fP \fIsnapremove\fP \fIMOUNTPOINT\fP [\fICOUNT\fP [\fIPROP\fP \fIVALUE\fP [\.\.\.]]]
.PP
.nf
.fam C
        Removes a number of old snapshots, given some conditions.
        COUNT defaults to "5".
        snapremove will delete the snpashots with the smallest
        snapshot.timestamp values first.

        Examples:

        Remove the 2 oldest snapshots of /
          # butter snapremove / 2

        Remove the 5 oldest "hourly" snapshots of / and /home (10 total)
          # butter snapremove /,/home 5 snapshot.type hourly

.fam T
.fi
\fBbutter\fP \fIset\fP \fIMOUNTPOINT\fP \fIPROP\fP \fIVALUE\fP [\.\.\.]
.PP
.nf
.fam C
        Set some properties.
        The submitted properties must be validated by butter
        Arbitrary properties can be set with the "custom." prefix.
        Some properties are read-only and you should not attempt to modify
        them, such as:

          o snapshot.is
          o mountpoint
          o uuid

        Example:

        Set the default maximum number of snapshots for /var/log
          # butter set /var/log snapshot.default.max 3

.fam T
.fi
\fBbutter\fP \fIget\fP [\fB-H\fP] [\fB-o\fP \fIvalues\fP] \fIMOUNTPOINT\fP \fIPROP\fP [\fIPROP\fP [\.\.\.]]
.PP
.nf
.fam C
        Get some properties in a nice table.

        Options:

          o -H: suppress headers
          o -o values: only print values

        Example:

.nf
.fam C
          # butter get / uuid snapshot.default.max
          # butter get -H /var/log snapshot.daily.max

.fam T
.fi
\fBbutter\fP \fIhelp\fP
.PP
.nf
.fam C
        Display this help text

.fam T
.fi
\fBbutter\fP \fIfind\fP [\fIPROP\fP \fIVALUE\fP [\.\.\.]]
.PP
.nf
.fam C
        Find snapshots or subvolumes that match PROP=VALUE for submitted
        properties and values.

        Example:

        Find snapshots with type "foo"
          # butter find snapshot.is 1 snapshot.type foo

